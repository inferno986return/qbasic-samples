DECLARE SUB MAKEcard ()
DECLARE FUNCTION Rand% (hi%, lo%)
REDIM SHARED CardPics(31304) AS INTEGER, Card(1 TO 52) AS INTEGER
Card(1) = 0: Card(2) = 602: SCREEN 12: MAKEcard: RANDOMIZE TIMER
GET (0, 0)-(39, 59), CardPics(Card(1))
OPEN "cardpics.dat" FOR BINARY AS #1
FOR X% = 0 TO 601: PUT #1, X% * 2 + 1, CardPics(Card(1) + X%): NEXT
FOR X% = 0 TO 601: GET #1, X% * 2 + 1, CardPics(Card(2) + X%): NEXT
CLOSE 1
WHILE INKEY$ = ""
  PUT (Rand(599, 0), Rand(419, 0)), CardPics(Card(2)), PSET
WEND: SCREEN 0: WIDTH 80, 25: SYSTEM

SUB MAKEcard
  c$ = ""
  c$ = c$ + "========================================"
  c$ = c$ + "===                                  ==="
  c$ = c$ + "==   0000                             =="
  c$ = c$ + "==   0000                             =="
  c$ = c$ + "==  00  00                            =="
  c$ = c$ + "==  00  00                            =="
  c$ = c$ + "== 00000000                           =="
  c$ = c$ + "== 00    00                           =="
  c$ = c$ + "== 00    00                           =="
  c$ = c$ + "== 000  000                           =="
  c$ = c$ + "==                                    =="
  c$ = c$ + "==                                    =="
  c$ = c$ + "==                                    =="
  c$ = c$ + "==                                    =="
  c$ = c$ + "==                                    =="
  c$ = c$ + "==                 00                 =="
  c$ = c$ + "==                0000                =="
  c$ = c$ + "==               000000               =="
  c$ = c$ + "==              00000000              =="
  c$ = c$ + "==             0000000000             =="
  c$ = c$ + "==            000000000000            =="
  c$ = c$ + "==           00000000000000           =="
  c$ = c$ + "==          0000000000000000          =="
  c$ = c$ + "==         000000000000000000         =="
  c$ = c$ + "==        00000000000000000000        =="
  c$ = c$ + "==       0000000000000000000000       =="
  c$ = c$ + "==      000000000000000000000000      =="
  c$ = c$ + "==     00000000000000000000000000     =="
  c$ = c$ + "==    0000000000000000000000000000    =="
  c$ = c$ + "==   000000000000000000000000000000   =="
  c$ = c$ + "==   000000000000000000000000000000   =="
  c$ = c$ + "==  00000000000000000000000000000000  =="
  c$ = c$ + "==  00000000000000000000000000000000  =="
  c$ = c$ + "==  00000000000000000000000000000000  =="
  c$ = c$ + "==  00000000000000000000000000000000  =="
  c$ = c$ + "==   000000000000000000000000000000   =="
  c$ = c$ + "==   000000000000000000000000000000   =="
  c$ = c$ + "==     00000000000000000000000000     =="
  c$ = c$ + "==       0000000000000000000000       =="
  c$ = c$ + "==         000000000 00000000         =="
  c$ = c$ + "==           00000 00 00000           =="
  c$ = c$ + "==                 00                 =="
  c$ = c$ + "==                0000                =="
  c$ = c$ + "==                00000               =="
  c$ = c$ + "==                                    =="
  c$ = c$ + "==                                    =="
  c$ = c$ + "==                                    =="
  c$ = c$ + "==                                    =="
  c$ = c$ + "==                                    =="
  c$ = c$ + "==                                    =="
  c$ = c$ + "==                           000  000 =="
  c$ = c$ + "==                           00    00 =="
  c$ = c$ + "==                           00    00 =="
  c$ = c$ + "==                           00000000 =="
  c$ = c$ + "==                            00  00  =="
  c$ = c$ + "==                            00  00  =="
  c$ = c$ + "==                             0000   =="
  c$ = c$ + "==                             0000   =="
  c$ = c$ + "===                                  ==="
  c$ = c$ + "========================================"
  L% = LEN(c$)
  FOR t% = 0 TO L%
    SELECT CASE MID$(c$, t% + 1, 1)
      CASE "=": PSET (t% MOD 40, t% \ 40), 2
      CASE " ": PSET (t% MOD 40, t% \ 40), 15
      CASE "0": PSET (t% MOD 40, t% \ 40), 0
      CASE "R": PSET (t% MOD 40, t% \ 40), 4
      CASE "Y": PSET (t% MOD 40, t% \ 40), 14
      CASE "B": PSET (t% MOD 40, t% \ 40), 1
    END SELECT
  NEXT
END SUB

FUNCTION Rand% (hi%, lo%) : range% = hi% - lo% + 1
  Rand% = ((RND * 32767) MOD range%) + lo%: END FUNCTION

